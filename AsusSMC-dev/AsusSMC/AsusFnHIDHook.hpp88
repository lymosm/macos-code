#ifndef AsusFnHIDHook_hpp
#define AsusFnHIDHook_hpp

#include <IOKit/hid/IOHIDEventDriver.h>

class AsusFnHIDHook {
public:
    static void install();
private:
    using HandleHIDEventFunc = IOReturn (*)(IOHIDEventDriver *, IOHIDEvent *, IOOptionBits);
    static HandleHIDEventFunc origHandleHIDEvent;

    static IOReturn customHandleHIDEvent(IOHIDEventDriver *that, IOHIDEvent *event, IOOptionBits options);
    static void hookDriver(IOHIDEventDriver *driver);
};
extern "C" void OSRuntimeModifyCPPVtable(void **vtableEntry, void *newFunc);

#endif /* AsusFnHIDHook_hpp */

